<!DOCTYPE html>
<html lang="en">
<head>

  
  <meta charset="utf-8">
  <title>Recursion, what is it good for?</title>
  <meta name="description" content="Recursion, what is it good for?">
  <meta name="author" content="Stephan Fitzpatrick">

  
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://knowsuchagency.github.iocss/fonts.css">
  
  
  <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.1/build/pure-min.css" integrity="sha384-CCTZv2q9I9m3UOxRLaJneXrrqKwUNOzZ6NGEUMwHtShDJ+nCoiXJCAgi05KfkLGY" crossorigin="anonymous">
  
  
    <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.1/build/grids-responsive-min.css">
  
  <link rel="stylesheet" href="https://knowsuchagency.github.iocss/custom.css">

  
  
  <link rel="stylesheet" href="https://knowsuchagency.github.iohighlight/styles/default.css">
  
  <script src="https://knowsuchagency.github.iohighlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <meta name="generator" content="Hugo 0.27.1" />
  
</head>
<body>

<div class="header pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
    <div class="pure-u-11-12 pure-u-md-5-8">
        <div class="desktop pure-menu pure-menu-horizontal nav-menu">
            
            <a href="https://knowsuchagency.github.io" class="site-title pure-menu-heading">Journal Panic</a>
            <ul class="pure-menu-list">
				
                
				
                <li class="pure-menu-item">
                    <a href="https://knowsuchagency.github.ioabout/" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
        <div class="mobile pure-menu nav-menu">
            <a href="https://knowsuchagency.github.io/" class="pure-menu-heading" id="toggle-home">Journal Panic</a>
            <a href="#" id="toggle-btn">&#9776;</a>
            <ul class="pure-menu-list" id="toggle-content" style="display:none;">
                
				
                
				
                <li class="pure-menu-item">
                    <a href="https://knowsuchagency.github.ioabout" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>

<div class="pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
	<div class="pure-u-11-12 pure-u-md-5-8">
        <div class="post">

            <div class="post-title">
                <p class="footnote">
                    <time class="">2017-09-20</time>
		            
                    
                    

                    

                    
                </p>
                <h1>Recursion, what is it good for?</h1>
            </div>

            <div class="post-content">
                <p></p>

<h2 id="in-the-beginning-there-was-the-imperative">In the beginning, there was the Imperative</h2>

<p>It all started when a friend of mine asked for help on their introductory computer science class.</p>

<p>They had been assigned the task of writing a program that would ask a user to <strong>input a number of seconds</strong>, and then print how much time that was <strong>in terms of weeks, days, hours, and seconds</strong>.</p>

<p>For example,</p>

<pre><code>
f(0) -&gt; &quot;0 Seconds&quot;
f(100) -&gt; &quot;1 Minute 40 Seconds&quot;
f(86400) -&gt; &quot;1 Day&quot;
f(172801) -&gt; &quot;2 Days 1 Second&quot;
</code></pre>

<h3 id="full-disclaimer">Full Disclaimer</h3>

<blockquote>
<p>I had the full intention of writing only about recursion but ended up getting side-tracked with closures, generators, and a couple other things and was too lazy to change the title once I finished typing this out. So feel free to hate on me if you feel like you got baited and switched by having to read about those other topics at least as well as recursion in the next minute or two of your life.</p>
</blockquote>

<p>My friend had to turn in the assignment that night, so I quickly banged out a naive solution with the promise that I&rsquo;d go over it with them later.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">def</span> <span class="nf">seconds_to_string</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;seconds must be greater than zero&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">seconds</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0 seconds&#39;</span>
    
    <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    <span class="n">weeks</span> <span class="o">=</span> <span class="n">seconds</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">/</span> <span class="mi">24</span> <span class="o">//</span> <span class="mi">7</span>
    <span class="k">if</span> <span class="n">weeks</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="n">f</span><span class="s1">&#39;{weeks} weeks &#39;</span>
    <span class="n">seconds</span> <span class="o">-=</span> <span class="n">weeks</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span>
    
    <span class="n">days</span> <span class="o">=</span> <span class="n">seconds</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">//</span> <span class="mi">24</span>
    <span class="k">if</span> <span class="n">days</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="n">f</span><span class="s1">&#39;{days} days &#39;</span>
    <span class="n">seconds</span> <span class="o">-=</span> <span class="n">days</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span>
    
    <span class="n">hours</span> <span class="o">=</span> <span class="n">seconds</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">//</span> <span class="mi">60</span>
    <span class="k">if</span> <span class="n">hours</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="n">f</span><span class="s1">&#39;{hours} hours &#39;</span>
    <span class="n">seconds</span> <span class="o">-=</span> <span class="n">hours</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span>
    
    <span class="n">minutes</span> <span class="o">=</span> <span class="n">seconds</span> <span class="o">//</span> <span class="mi">60</span>
    <span class="k">if</span> <span class="n">minutes</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="n">f</span><span class="s1">&#39;{minutes} minutes &#39;</span>
    <span class="n">seconds</span> <span class="o">-=</span> <span class="n">minutes</span> <span class="o">*</span> <span class="mi">60</span>
        
    <span class="k">if</span> <span class="n">seconds</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="n">f</span><span class="s1">&#39;{seconds} seconds&#39;</span>
        
    <span class="k">return</span> <span class="n">string</span>
    
    
<span class="n">seconds_to_string</span><span class="p">(</span><span class="mi">987987</span><span class="p">)</span>
</code></pre></div>

<pre><code>'1.0 weeks 4.0 days 10.0 hours 26.0 minutes 27.0 seconds'
</code></pre>

<h2 id="where-do-we-go-from-here">Where do we go from here?</h2>

<p>This function works, but one thing we might want to do is to create a type of object that more clearly illustrates the semantics of a time measurement.</p>

<p>For starters, it would be great if we could <a href="https://fsharpforfunandprofit.com/posts/designing-with-types-making-illegal-states-unrepresentable/">make illegal states unrepresentable</a> as much as possible. For example, let&rsquo;s say that we only want units of time like <code>Weeks, Days, Hours, Minutes, and Seconds</code>, to be represented as natural numbers. That means no negative numbers or floating point representations of those types.</p>

<p>For the sake of argument, let&rsquo;s also say that we want equivalent units of time to be equal to one another. We also want to be able to perform arithmetic with our units in ways that make sense.</p>

<p>Lastly, units of time should know how to represent themselves in string form.</p>

<p>i.e.</p>

<pre><code>
Days(7) == Weeks(1)

Minutes(1) + Seconds(20) -&gt; Minutes(1) # whole numbers only, left unit takes precedent

Seconds(20) + Minutes(1) -&gt; Seconds(80)

str(Seconds(0)) -&gt; '0 Seconds'
str(Seconds(1)) -&gt; '1 Second'
str(Seconds(101)) -&gt; '101 Seconds'
</code></pre>

<hr />
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>

<span class="k">class</span> <span class="nc">TimeUnit</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A class that defines the semantics of a unit of time i.e. seconds, minutes, hours etc.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ensure no negative units are created.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{cls.__name__} must be greater than zero. x={x}&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span><span class="o">+</span><span class="n">other</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__radd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span><span class="o">-</span><span class="n">other</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__sub__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span><span class="o">/</span><span class="n">other</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__div__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">singular</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">singular</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;{int(self)} {units}&#39;</span>
    
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_seconds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">to_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
<span class="c1"># Create our Seconds, Hours, Days, and Weeks classes</span>
<span class="c1"># from out TimeUnit base class</span>

<span class="k">class</span> <span class="nc">Seconds</span><span class="p">(</span><span class="n">TimeUnit</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_seconds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>


<span class="k">class</span> <span class="nc">Minutes</span><span class="p">(</span><span class="n">TimeUnit</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_seconds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">to_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Seconds</span><span class="p">(</span><span class="bp">self</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Hours</span><span class="p">(</span><span class="n">TimeUnit</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_seconds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">to_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Seconds</span><span class="p">(</span><span class="bp">self</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Days</span><span class="p">(</span><span class="n">TimeUnit</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_seconds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">to_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Seconds</span><span class="p">(</span><span class="bp">self</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Weeks</span><span class="p">(</span><span class="n">TimeUnit</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_seconds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">to_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Seconds</span><span class="p">(</span><span class="bp">self</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="c1"># poor man&#39;s tests</span>
<span class="c1"># in the real world, we should test all the operations</span>
<span class="c1"># ideally using something like hypothesis, but this hopefully</span>
<span class="c1"># serves well enough to demonstrate that our units of measure</span>
<span class="c1"># now work well with one-another</span>

<span class="k">def</span> <span class="nf">test_equality</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">Seconds</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">==</span> <span class="n">Minutes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">Minutes</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">==</span> <span class="n">Hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">Hours</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">==</span> <span class="n">Days</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">Days</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="n">Weeks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;equality tests passed&#39;</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">test_conversions</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">Seconds</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Minutes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">61</span>
    <span class="k">assert</span> <span class="n">Minutes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Seconds</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">Minutes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">61</span>
    <span class="k">assert</span> <span class="n">Hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Minutes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">Hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Days</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
    <span class="k">assert</span> <span class="n">Days</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">Days</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Weeks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span>
    <span class="k">assert</span> <span class="n">Weeks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Days</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;conversions passed&#39;</span><span class="p">)</span>
    
<span class="n">test_equality</span><span class="p">()</span>
<span class="n">test_conversions</span><span class="p">()</span>
</code></pre></div>

<pre><code>equality tests passed
conversions passed
</code></pre>

<h2 id="why-all-the-new-code">Why all the new code?</h2>

<p>For starters, we know that any instances of our units of time will be positive whole numbers. Additionally, we can also compare and convert our units of measurement to one another pretty easily now that we&rsquo;ve defined the respective <em>dunder</em> methods</p>

<p>So that&rsquo;s pretty cool. We can even continue to use our old function with our new types so long as we make sure the argument is in <em>seconds</em>.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="n">seconds_to_string</span><span class="p">(</span>
    <span class="n">Weeks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">()</span> <span class="o">+</span> \
    <span class="n">Hours</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">()</span> <span class="o">+</span> \
    <span class="n">Seconds</span><span class="p">(</span><span class="mi">78</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

<pre><code>'1.0 weeks 3.0 hours 1.0 minutes 18.0 seconds'
</code></pre>

<h3 id="comprehensions-http-python-3-patterns-idioms-test-readthedocs-io-en-latest-comprehensions-html"><a href="http://python-3-patterns-idioms-test.readthedocs.io/en/latest/Comprehensions.html">Comprehensions</a></h3>

<p>Before we move on, we&rsquo;re going to see a few examples of comprehensions.</p>

<p>For the uninitiated, comprehensions follow the following format,</p>

<p>[<strong>statement</strong> for <strong>variable</strong> in <strong>iterable</strong> if <strong>optional predicate</strong>]</p>

<p>in addition, the <code>.join</code> method of a string takes an iterable of strings as an argument and returns a string that joins the elements of the iterable together.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="c1"># for a comma-separated list of even numbers 0-through-10</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">random_things</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pizza&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s2">&quot;beer&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;netflix&#39;</span><span class="p">]</span>
<span class="n">things_string</span> <span class="o">=</span> <span class="s1">&#39;++&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">random_things</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;all the things:&#39;</span><span class="p">,</span> <span class="n">things_string</span> <span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># notice the predicate can be a variable itself, it will be</span>
<span class="c1"># evaluated on its &quot;truthiness&quot;</span>
<span class="n">some_things_string</span> <span class="o">=</span> <span class="s1">&#39;++&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">random_things</span> <span class="k">if</span> <span class="n">thing</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;only that which is True:&#39;</span><span class="p">,</span> <span class="n">some_things_string</span><span class="p">)</span>
</code></pre></div>

<pre><code>0, 2, 4, 6, 8

all the things: pizza++None++beer++0++42++{}++netflix

only that which is True: pizza++beer++42++netflix
</code></pre>

<p>Anyway, we can still do better.</p>

<p>Let&rsquo;s start by re-writing our old function to take any instance <strong>TimeUnit</strong>. Since <strong>TimeUnit</strong> instances can&rsquo;t be negative, we don&rsquo;t have to test for that in our function. In addition, every <strong>TimeUnit</strong> has a <code>from_seconds</code> method and knows how to perform arithmetic correctly with other members of the same type &ndash; saving us some code.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">def</span> <span class="nf">time_unit_to_string</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
    
    <span class="n">seconds</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">seconds</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    
    <span class="c1"># a stack where we&#39;ll store all our units</span>
    <span class="c1"># greater than one</span>
    
    <span class="n">units</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">weeks</span> <span class="o">=</span> <span class="n">Weeks</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">weeks</span><span class="p">:</span>
        <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">weeks</span><span class="p">))</span>
    <span class="n">seconds</span> <span class="o">-=</span> <span class="n">weeks</span>
    
    <span class="n">days</span> <span class="o">=</span> <span class="n">Days</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">days</span><span class="p">:</span>
        <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">days</span><span class="p">))</span>
    <span class="n">seconds</span> <span class="o">-=</span> <span class="n">days</span>
    
    <span class="n">hours</span> <span class="o">=</span> <span class="n">Hours</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hours</span><span class="p">:</span>
        <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">hours</span><span class="p">))</span>
    <span class="n">seconds</span> <span class="o">-=</span> <span class="n">hours</span>
    
    <span class="n">minutes</span> <span class="o">=</span> <span class="n">Minutes</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">minutes</span><span class="p">:</span>
        <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">minutes</span><span class="p">))</span>
    <span class="n">seconds</span> <span class="o">-=</span> <span class="n">minutes</span>
        
    <span class="k">if</span> <span class="n">seconds</span><span class="p">:</span>
        <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">seconds</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
</code></pre></div>

<h2 id="you-promised-recursion">You promised recursion</h2>

<p>&ldquo;But, Stephan&rdquo;, you interject.</p>

<p>&ldquo;Can&rsquo;t we do better than to have a stack in our <code>time_unit_to_string</code> function where we append the values we want to return? Also, constantly changing the value of variables like <code>seconds</code> in the function makes me sad. I like it when my program is correct, but I LOVE it when it&rsquo;s pure, idiomatic, functional, well-tested, and well-documented.&rdquo;</p>

<p>I wipe a tear from my eye, knowing the harsh vicissitudes of life may unfairly rob you of much of your innocent idealism, but recursion isn&rsquo;t going to explain itself itself itself itself&hellip;</p>

<h3 id="recursion">Recursion</h3>

<p>A <strong>recursive</strong> function, is simply a function that calls itself. A recursive function must have at least one <strong>base case</strong>, which is the point at which the function ceases to return from itself and actually spits something out.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="c1"># This contrived example of a recursive function that doesn&#39;t do much</span>

<span class="k">def</span> <span class="nf">diminish</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;this is the base case&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;called diminish({n})&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diminish</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">diminish</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span>
</code></pre></div>

<pre><code>called diminish(5)
called diminish(4)
called diminish(3)
called diminish(2)
called diminish(1)
this is the base case
</code></pre>

<h3 id="closures">Closures</h3>

<p>A <strong>closure</strong> is simply a fancy name for a function defined within another function. The inner function will have access to the higher function&rsquo;s <a href="https://stackoverflow.com/questions/3913217/what-are-python-namespaces-all-about">namespace</a>.</p>

<p>Let&rsquo;s create a function that allows us to &ldquo;count&rdquo; by certain numbers as an example.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="c1"># we define from_ as a nonlocal variable in our closure </span>
<span class="c1"># since we want to change its value from that scope,</span>
<span class="c1"># not just &quot;read&quot; it</span>

<span class="k">def</span> <span class="nf">counts</span><span class="p">(</span><span class="n">from_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">closure</span><span class="p">():</span>
        <span class="n">nonlocal</span> <span class="n">from_</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">from_</span><span class="o">+</span><span class="n">by</span>
        <span class="n">from_</span> <span class="o">+=</span> <span class="n">by</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">closure</span>

<span class="n">counter</span> <span class="o">=</span> <span class="n">counts</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">counter</span><span class="p">(),</span> <span class="n">counter</span><span class="p">(),</span> <span class="n">counter</span><span class="p">())</span>

<span class="n">count_from_10_by_5</span> <span class="o">=</span> <span class="n">counts</span><span class="p">(</span><span class="n">from_</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count_from_10_by_5</span><span class="p">())</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
</code></pre></div>

<pre><code>1 2 3
15 20 25
</code></pre>

<h3 id="caveat">Caveat</h3>

<p>This following example is just one way you <em>could</em> use recursion to avoid loops and changing variables. I am <strong>definitely</strong> not trying to argue this is the &ldquo;best&rdquo; way to solve this particular problem, as we&rsquo;ll see. Also, I just want to make it clear that as a mere mortal that doesn&rsquo;t intuitively perceive the universe in its natural resplendent recursive beauty, this is probably (almost certainly) not the best example of a recursive function that solves our problem.</p>

<p>With that out of the way&hellip;</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">def</span> <span class="nf">seconds_to_string</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    <span class="c1"># coerce integers into our Seconds class</span>
    <span class="n">seconds</span> <span class="o">=</span> <span class="n">Seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">unit_class</span><span class="p">):</span>
        
        <span class="c1"># These are the base cases of the recursive function</span>
        <span class="c1"># where our function will eventually terminate and return</span>
        <span class="k">if</span> <span class="n">seconds</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">string</span><span class="p">:</span>
            <span class="c1"># in this case, the input was larger than sixty, so some unit of time</span>
            <span class="c1"># besides seconds was computed, but there are no seconds left over</span>
            
            <span class="c1"># since we append a space to each string we return in a recursive call</span>
            <span class="c1"># where some unit greater than 1 was computed, we need to strip the output</span>
            <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="c1"># in this case, we may or may not have computed units of time other than</span>
            <span class="c1"># seconds, but since we append the seconds string at the end -- after any</span>
            <span class="c1"># spaces -- we don&#39;t need to strip the output of whitespace</span>
            <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
        
        <span class="n">time_unit</span> <span class="o">=</span> <span class="n">unit_class</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
        
        <span class="c1"># if the unit of time is not zero i.e. `Weeks.from_seconds(800) == 0`</span>
        <span class="c1"># then we append the string for that unit of time to the last string</span>
        <span class="c1"># that was input to the function and add it as a parameter to the </span>
        <span class="c1"># next function call</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_unit</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="k">if</span> <span class="n">time_unit</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        
        <span class="k">if</span> <span class="n">time_unit</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">Weeks</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inner</span><span class="p">(</span><span class="n">seconds</span><span class="o">-</span><span class="n">time_unit</span><span class="p">,</span> <span class="n">string</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="n">Days</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">time_unit</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">Days</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inner</span><span class="p">(</span><span class="n">seconds</span><span class="o">-</span><span class="n">time_unit</span><span class="p">,</span> <span class="n">string</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="n">Hours</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">time_unit</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">Hours</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inner</span><span class="p">(</span><span class="n">seconds</span><span class="o">-</span><span class="n">time_unit</span><span class="p">,</span> <span class="n">string</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="n">Minutes</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">time_unit</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">Minutes</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inner</span><span class="p">(</span><span class="n">seconds</span><span class="o">-</span><span class="n">time_unit</span><span class="p">,</span> <span class="n">string</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="n">Seconds</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">inner</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">Weeks</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">test_string_func</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="n">input_</span> <span class="o">=</span> <span class="mi">8989</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">input_</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;2 Hours 29 Minutes 49 Seconds&#39;</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;{func.__name__}({input_}) -&gt; {output}&#39;</span>
    
    <span class="n">input_</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">input_</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;0 Seconds&#39;</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;{func.__name__}({input_}) -&gt; {output}&#39;</span>
    
    <span class="n">input_</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">input_</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;1 Minute&#39;</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;{func.__name__}({input_}) -&gt; {output}&#39;</span>
    
    <span class="n">input_</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">input_</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;1 Second&#39;</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;{func.__name__}({input_}) -&gt; {output}&#39;</span>
    
    <span class="n">input_</span> <span class="o">=</span> <span class="n">Seconds</span><span class="p">(</span><span class="mi">61</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Weeks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">input_</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;1 Week 1 Hour 1 Minute 1 Second&#39;</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;{func.__name__}({input_}) -&gt; {output}&#39;</span>
    
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;stringification tests passed for {func.__name__}&#39;</span><span class="p">)</span>
    
    
<span class="n">test_string_func</span><span class="p">(</span><span class="n">seconds_to_string</span><span class="p">)</span>
</code></pre></div>

<pre><code>stringification tests passed for seconds_to_string
</code></pre>

<h3 id="how-can-we-make-this-less-horrible">How can we make this less horrible?</h3>

<p>Well, for one, we could use iteration to avoid dispatching on the <code>time_class</code> argument in the recursive function</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">def</span> <span class="nf">seconds_to_string_with_for_loop</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    
    <span class="n">seconds</span> <span class="o">=</span> <span class="n">Seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">seconds</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">string</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="k">elif</span> <span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Weeks</span><span class="p">,</span> <span class="n">Days</span><span class="p">,</span> <span class="n">Hours</span><span class="p">,</span> <span class="n">Minutes</span><span class="p">,</span> <span class="n">Seconds</span><span class="p">):</span>
            <span class="n">time_unit</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">time_unit</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">inner</span><span class="p">(</span><span class="n">seconds</span><span class="o">-</span><span class="n">time_unit</span><span class="p">,</span> <span class="n">string</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_unit</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">inner</span><span class="p">(</span><span class="n">seconds</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">seconds_to_string_with_for_loop</span><span class="p">(</span><span class="mi">72783</span><span class="p">)</span>
</code></pre></div>

<pre><code>'20 Hours 13 Minutes 3 Seconds'
</code></pre>

<h3 id="closures-again">Closures, again</h3>

<p>Let&rsquo;s see another example with a factory function that uses a closure. Again, I don&rsquo;t think this is actually a good solution to this problem at all, but I think it&rsquo;s useful as an example in how one might think about using closures.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">def</span> <span class="nf">unit_factory</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    
    <span class="n">seconds</span> <span class="o">=</span> <span class="n">Seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_time_unit_instance</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
        <span class="n">nonlocal</span> <span class="n">seconds</span>
        <span class="n">time_unit</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
        <span class="n">seconds</span> <span class="o">-=</span> <span class="n">time_unit</span>
        <span class="k">return</span> <span class="n">time_unit</span>

    <span class="k">return</span> <span class="n">get_time_unit_instance</span>



<span class="k">def</span> <span class="nf">seconds_to_string_with_closure_factory</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">Seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">))</span>
    
    <span class="n">factory</span> <span class="o">=</span> <span class="n">unit_factory</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    <span class="n">time_units</span> <span class="o">=</span> <span class="p">(</span><span class="n">factory</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Weeks</span><span class="p">,</span> <span class="n">Days</span><span class="p">,</span> <span class="n">Hours</span><span class="p">,</span> <span class="n">Minutes</span><span class="p">,</span> <span class="n">Seconds</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">time_units</span> <span class="k">if</span> <span class="n">unit</span><span class="p">)</span>


<span class="n">seconds_to_string_with_closure_factory</span><span class="p">(</span><span class="mi">27364283</span><span class="p">)</span>
</code></pre></div>

<pre><code>'45 Weeks 1 Day 17 Hours 11 Minutes 23 Seconds'
</code></pre>

<h3 id="sweet-sweet-generators-https-realpython-com-blog-python-introduction-to-python-generators">Sweet, Sweet <a href="https://realpython.com/blog/python/introduction-to-python-generators/">Generators</a></h3>

<p>Lastly, a generator is a callable object in Python (normally just a function) that abides by the iterator protocol (you can loop over it) that <em>yields</em> values as opposed to only <em>returning</em> them.</p>

<p>In this example, you can clearly understand what&rsquo;s happening by reading the code, which I would argue is what Python is all about.</p>

<p>Rather than <strong>imperatively</strong> decrementing seconds each time we calculate a unit of time, or using a <strong>recursive</strong> function or <strong>closure</strong> to do the same thing, we rely on the semantics of the <strong>generator</strong> to do it for us much more clearly by decrementing the <code>sec</code> variable within the generator function&rsquo;s <em>own</em> scope <strong>after</strong> we yield the value we want! How cool is that?!</p>

<p>This works because the Python interpreter basically suspends execution and starts back up immediately after the yield statement of a generator function, so we know that <code>secs</code> will be decremented before the next iteration of the loop, every time.</p>

<p>I think this really makes more intuitive sense than any of the previous examples, but at least we may have a couple more tools in our mental toolbox now that we&rsquo;ve seen a couple different solutions.</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="k">def</span> <span class="nf">seconds_to_string_with_generator_func</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    
    <span class="n">seconds</span> <span class="o">=</span> <span class="n">Seconds</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">gen_unit_strings</span><span class="p">(</span><span class="n">secs</span><span class="p">):</span>
        <span class="n">units</span> <span class="o">=</span> <span class="p">(</span><span class="n">Weeks</span><span class="p">,</span> <span class="n">Days</span><span class="p">,</span> <span class="n">Hours</span><span class="p">,</span> <span class="n">Minutes</span><span class="p">,</span> <span class="n">Seconds</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">secs</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">units</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">unit</span><span class="p">:</span> <span class="k">yield</span> <span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
            <span class="n">secs</span> <span class="o">-=</span> <span class="n">unit</span>
    
    <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gen_unit_strings</span><span class="p">(</span><span class="n">seconds</span><span class="p">))</span>


<span class="n">seconds_to_string_with_generator_func</span><span class="p">(</span><span class="mi">2342455</span><span class="p">)</span>
</code></pre></div>

<pre><code>'3 Weeks 6 Days 2 Hours 40 Minutes 55 Seconds'
</code></pre>
            </div>
        </div>
	</div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>

<div class="footer pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
    <div class="pure-u-11-12 pure-u-md-5-8">
        <div class="footer-content">
		  <div class="pure-menu pure-menu-horizontal">
              <ul>
			      
                  <li class="pure-menu-heading" id="foot-name">Stephan Fitzpatrick:</li>
                  
				  
                  
                  <li class="pure-menu-item">
                      <a href="mailto:knowsuchagency@gmail.com" class="pure-menu-link">Email</a>
                  </li>
                  
          
                  
                  <li class="pure-menu-item">
                      <a href="https://github.com/knowsuchagency" class="pure-menu-link">GitHub</a>
                  </li>
                  
          
                  
                  <li class="pure-menu-item">
                      <a href="https://www.linkedin.com/in/fitzpatrickstephan" class="pure-menu-link">LinkedIn</a>
                  </li>
                  
          
                  
                  <li class="pure-menu-item">
                      <a href="https://www.facebook.com/stephan.fitzpatrick" class="pure-menu-link">Facebook</a>
                  </li>
                  
          
                  
                  <li class="pure-menu-item">
                      <a href="https://twitter.com/knowsuchagency" class="pure-menu-link">Twitter</a>
                  </li>
                  
          
              </ul>
              <a href="#" class="pure-menu-heading pull-right" id="gototop-btn"></a>
          </div>
		  
		</div>
	  </div>
      <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>


<script src="https://knowsuchagency.github.iojs/jquery.min.js" type="text/javascript"></script>
<script src="https://knowsuchagency.github.iojs/jquery.timeago.js" type="text/javascript"></script>
<script type="text/javascript">
  $(function(){
    $("time.timeago").timeago();
  })
  $("#toggle-btn").click(function(){
    $("#toggle-content").toggle();
    if($(this).html() === "") {
        $(this).html("X")
    } else {
        $(this).html("")
    }
  });
  $(window).resize(function(){
    if(window.innerWidth > 768) {
      $(".desktop").removeAttr("style");
    }
  });
</script>

</body>
</html>

